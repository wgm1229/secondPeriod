一、vuex的介绍
> 状态管理器

1.什么是vuex？
> 集中管理需要跨组件共享的数据包

2.为什么使用vuex？
  + 管理共享数据更加方便
  + 在某个组件改变数据后，可以保证其他所有组件都能同步
  + 例如：购物车功能（加入购物车、购物车列表）

3.如何使用vuex？

##  vuex的使用流程
1.在项目中安装vuex
```
npm i vuex -S
```

2.在项目中创建store/index.js状态机模块，并定义状态机对象
```
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex)
const store = new Vuex.Store({
  state: { //相当于组件中的 data
    count: 0
  },
  mutations: {  //相当于组件中的 methods，修改state中的数据
    increment (state) {
      state.count++
    }
  }
})
export default store //导出store对象
```
3.在main.js中引入store状态机，并注入到Vue实例中

4.在组件computed中提取状态机数据
this.$store.state.数据 
```
computed: {
  count() {
    return this.$store.state.num 
  }
},
```

5.在组件的methods中，通过commit触发状态机的mutations
> 状态机数据的改变只能由mutation来完成
this.$store.commit('mutation的方法名')
```
handlePlus() {
  this.$store.commit('plus')  //触发store状态机中的某个mutation
}
```

## vuex的核心方法

1.state       相当于组件的data
```
组件中提取state的方法
this.$store.state.数据名
```

2.getters     相当于组件的computed
> 能够实时根据最新的state，运算得到新的数据包

组件中提取getters的方法
this.$store.getters.数据名
```
getters:{
  filterCart(state){ //筛选state中cart的价格100以内的商品并返回
    let arr = state.cart.filter(item=>{
      return item.price<100  
    })
    return arr
  }
},
```

3.mutations   相当于组件的methods
> 只要mutation被触发，state一定会发生可预测的变化

```
组件中触发mutations
this.$store.commit('mutation的名称',参数数据包)
```

4.actions     异步action
> 如果对于状态机的数据操作，需要等到在线请求完成后，延迟修改
例如：点击加入购物车---触发异步action----发起ajax请求---请求成功----触发mutation---修改state
                                                |----请求失败----不需要触发mutations，只需告知用户
```
组件中触发actions
this.$store.dispatch('action的名称',参数数据包)
```
在actions中context代表这个store示例，里面有state、getters、commit(mutations)、dispatch(actions)属性，可以通过context.属性调用
```
actions: {
    addCartDelay(context,obj){
        console.log(context)
        setTimeout(() => {
            context.commit('addCartList',obj)
        }, 2000);
    }
}
```
## 原生JS数组操作方法回顾
[文档](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/filter)

## modules将vuex状态机进行模块化
> 如果项目比较大，将所有状态数据放在同一个js模块中的话，会比较臃肿，难易维护
> 将上面演示的状态机提取为两个独立模块

1.模块内部的命名空间
> 当命名空间默认关闭的时候，只有state是模块局部的，提取的时候需要制定模块名

return this.$store.state.模块名.数据名 
```
count() {
  return this.$store.state.count.num 
},
```
2.开启所有模块的命名空间
> 模块内部的所有数据、方法都需要携带模块名才能访问
```
namespaced:true  //开启命名空间
```

3.开启命名空间后对状态机的操作方法
  + state
  ```
  this.$store.state.模块名.数据名
  ```
  + getters
  ```
  this.$store.getters['模块名/属性名']
  ```
  + mutations
  ```
  this.$store.commit('模块名/mutation名')
  ```
  + actions
  ```
  this.$store.dispatch('模块名/dispatch名')
  ```

## 课后任务
1. 熟悉vuex基本使用方式

2. 熟悉vuex模块化 【项目中更推荐、更常用】

3. 拓展了解一下vuex的辅助函数 (简化vuex操作的语法)
  + mapState
  + mapGetters
  + mapMutations
  + mapActions



